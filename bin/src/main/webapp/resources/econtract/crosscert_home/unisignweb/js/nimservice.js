var __nimservice=function(k){function m(a,b,c){var f=JSON.parse(a),d={};d.messageNumber=b;d.operation=f.operation;d.callback=c;d.valid=!0;10<=w&&(w=0);s[w]=d;w+=1;h+=1;try{document.getElementById("hsmiframe").contentWindow.postMessage(a,A)}catch(e){null!=c&&c(-1)}}function q(){return"touchen"==k.ESVS.SecureKeyboardType&&k.bsUtil().isTouchEnKeyUsable()?1:"ahnlab"==k.ESVS.SecureKeyboardType&&k.bsUtil().isAhnlabProtectorUsable()?2:0}function n(a){return 0==q()?k.bsUtil().GetEnvelopedPwd(a):a}function F(a){m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[0],manager:"ccsign"}),h,a)}function I(a,b,c,d,e){m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[7],manager:"ccsign",version:a,siteInfo:b,securityInfo:c,downloadURL:d}),h,e)}function G(a,b,c,d,e,t,g){m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[9],manager:"ccsign",sitecode:a,modcode:b,siteURL:c,serviceIP:d,servicePort:e,downloadURL:t}),h,g)}function J(a,b){if(0!=a.resultCode)d=a.resultCode,e=a.resultMessage,b(d,e);else if(a.disklist){var c=eval(a.disklist);b(a.resultCode,a.resultMessage,c)}else b(a.resultCode,a.resultMessage,"")}function K(a,b){if(0!=a.resultCode)d=a.resultCode,e=a.resultMessage,b(d,e);else if(a.hsmlist){var c=eval(a.hsmlist);b(a.resultCode,a.resultMessage,c)}else b(a.resultCode,a.resultMessage,"")}function C(a,b,c,d){a={messageNumber:h,sessionID:""+l,operation:f[42],manager:"ccsign",pki:k.ESVS.PKI,lang:"ko_kr"==k.ESVS.Language?0:1,device:a,drive:b,pin:n(c),options:{seckeyboard:q()}};m(JSON.stringify(a),h,d)}function D(a,b){m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[43],manager:"ccsign",index:a}),h,b)}function H(a,b,c,d,e,t,g,x,k,L){a={messageNumber:h,sessionID:""+l,operation:f[24],manager:"ccsign",index:a,pwd:n(b),input:{inputdata:{plaintype:c,hashalg:d,plaintext:e}},inCon:!0==g?1:0,charset:t,kmcert:x,multiuse:!0==k?1:0,options:{seckeyboard:q()}};m(JSON.stringify(a),h,L)}function M(a,b){if(0!=a.resultCode)d=a.resultCode,e=a.resultMessage,b(d,e);else if(a.hsmlist){var c=eval(a.disklist);b(a.resultCode,a.resultMessage,c)}else b(a.resultCode,a.resultMessage,"")}function N(a,b){if(0!=a.resultCode)d=a.resultCode,e=a.resultMessage,b(a.resultCode,a.resultMessage);else if(a.disklist){var c=eval(a.disklist);b(a.resultCode,a.resultMessage,c)}else b(a.resultCode,a.resultMessage,"")}function u(a){return 1*a.replace(/\./g,"")}function y(a){var b=0;switch(a){case 0:for(b=0;b<s.length;b++)if(s[b].operation==f[42]||s[b].operation==f[43])s[b].valid=!1;break;case 1:for(b=0;b<s.length;b++)s[b].operation==f[43]&&(s[b].valid=!1)}}var h=0,l=Math.random(),f="GetVersion InitUniSignWebToolkit GetLastErrorCode GetLastErrorMessage GetCertForKeyboardEncrypt SetSecureField GetDiskList SetMobileOptions GetHSMList SetUSIMOptions IsInstalledUSIMModule ClearAllUserCertList CopyCert DeleteCert ChangePassword ImportCert ExportCert GetPfxCertList VerifyCertificate GetCACertificates CheckPassword CheckSCardConnected CheckSCardPin GetSignDataP1 GetSignDataP7 VerifyP1SignData VerifySignedData GetSignFileP7 VerifyVID ExportCertEx ImportCertEx MakeHash EnvelopData DeEnvelopData EncryptData EncryptDataWithSymmKey DecryptDataWithSymmKey MakeXMLDSIG IssueCertificate RenewCertificate RevokeCertificate IssueKMCertificate GetAllUserCertListNum GetSignCertFromCertList VerifySignedFile CheckPasswdCombination CheckNewPasswdCombination GetBackupedDriveList BackupToUSB GetBackupedSlot RecoverFromUSB GetSDList IsSDInstalled GetMacAddress GetBackupedCertList CheckConnectToCAServer SetSystemTimeFromTimeServer IsUBIkeyInstalled".split(" "),O={device:2,name:"PKCS#11 TOKEN"},v=!1,z=null,d="",e="",P=k.nimVersion,w=0,s=[],A="https://127.0.0.1:15018",E=0,B=function(a){if(a.origin==A&&(v=!0,!(null==a.data||0>=a.data.length))){var b=0,c=null;a=JSON.parse(a.data);for(b=0;b<s.length;b++)if("object"===typeof s[b]&&s[b].messageNumber==a.messageNumber){if(!1==s[b].valid)return;c=s[b].callback;s[b]=0;break}268500992==a.resultCode&&(k.uiUtil().msgBox(k.uiUtil().getErrorMessageLang().IDS_MSGBOX_LOCALSERVER_UNLOAD),k.ActiveUI.dispose());if("ccsign"==a.manager||"ccmanager"==a.manager||"ccmanager_exp"==a.manager)a.operation==f[0]?(b=c,0!=a.resultCode?(d=a.resultCode,e=a.resultMessage,b(a.resultCode,a.resultMessage)):(z=a.version,c=z.split("."),z=c[0]+"."+c[1]+"."+c[2]+".0",b(a.resultCode,a.resultMessage,a.version))):a.operation==f[1]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[4]?(b=c,0!=a.resultCode?(d=a.resultCode,e=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.pub)):a.operation==f[6]?J(a,c):a.operation==f[7]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[8]?K(a,c):a.operation==f[9]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[10]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[11]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[12]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[13]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[14]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[15]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[16]?(b=c,0!=a.resultCode?(d=a.resultCode,e=a.resultMessage,b(d,e)):b(a.resultCode,a.resultMessage,a.filepath)):a.operation==f[17]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage,a.index)):a.operation==f[18]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[19]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage,a.cacert,a.rootcert,a.rootcerthex)):a.operation==f[20]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[21]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[22]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[23]?(b=c,0!=a.resultCode?(d=a.resultCode,e=a.resultMessage,b(d,e)):b(a.resultCode,a.resultMessage,a.signeddata,a.encRValue,a.cert,a.label)):a.operation==f[24]||a.operation==f[27]?(b=c,0!=a.resultCode?(d=a.resultCode,e=a.resultMessage,b(d,e)):b(a.resultCode,a.resultMessage,a.signeddata,a.encRValue,a.cert,a.label)):a.operation==f[25]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[26]?(b=c,0!=a.resultCode?(d=a.resultCode,e=a.resultMessage,b(d,e)):b(a.resultCode,a.resultMessage,a.plaintext)):a.operation==f[28]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[29]?(b=c,0!=a.resultCode?(d=a.resultCode,e=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.pfx)):a.operation==f[30]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[31]?(b=c,0!=a.resultCode?(d=a.resultCode,e=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.hashdata)):a.operation==f[32]?(b=c,0!=a.resultCode?(d=a.resultCode,e=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.envelopeddata)):a.operation==f[33]?(b=c,0!=a.resultCode?(d=a.resultCode,e=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.plaintext)):a.operation==f[34]?(b=c,0!=a.resultCode?(d=a.resultCode,e=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.encrypteddata)):a.operation==f[35]?(b=c,0!=a.resultCode?(d=a.resultCode,e=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.encrypteddata)):a.operation==f[36]?(b=c,0!=a.resultCode?(d=a.resultCode,e=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.plaintext)):a.operation==f[37]?(b=c,0!=a.resultCode?(d=a.resultCode,e=a.resultMessage,b(d,e)):b(a.resultCode,a.resultMessage,a.signeddata,a.encRValue,a.cert,a.label)):a.operation==f[38]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[39]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage,a.cert)):a.operation==f[40]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[41]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[42]?(b=c,0!=a.resultCode?(d=a.resultCode,e=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.certcnt)):a.operation==f[43]?(b=c,0!=a.resultCode?(d=a.resultCode,e=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.signcert)):a.operation==f[44]?(b=c,0!=a.resultCode?(d=a.resultCode,e=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.plaintext,a.signcert)):a.operation==f[45]||a.operation==f[46]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[47]?N(a,c):a.operation==f[48]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[49]?(b=c,0!=a.resultCode?(d=a.resultCode,e=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.slot)):a.operation==f[50]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[51]?M(a,c):a.operation==f[52]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[53]?(b=c,0!=a.resultCode?(d=a.resultCode,e=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.mac)):a.operation==f[54]?(b=c,0!=a.resultCode?(d=a.resultCode,e=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.certlist)):a.operation==f[55]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[56]?(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[57]&&(0!=a.resultCode&&(d=a.resultCode,e=a.resultMessage),c(a.resultCode,a.resultMessage))}},Q=function(a){v=!1;var b=!0,c=function(c,d){b&&(b=!1,c&&c.parentNode&&c.parentNode.removeChild(c),d?setTimeout(function(){F(function(b,c,e){if("0"==b||0==b){b=e.split(".");b=b[0]+"."+b[1]+"."+b[2]+".0";a:{c=b;b=P.split(".");c=c.split(".");len=3;for(e=0;e<len;e++)if(b[e]&&!c[e]&&0<u(b[e])||u(b[e])>u(c[e])){b=!0;break a}else if(c[e]&&!b[e]&&0<u(c[e])||u(b[e])<u(c[e])){b=!1;break a}b=!1}b?null!=parent?parent.document.location=k.nimCheckUrl:document.location.href=k.nimCheckUrl:(v=!0,a(d))}})},300):(v=d,a(d)))},d;-1!=navigator.userAgent.indexOf("MSIE 7.0")?d=document.createElement("<img id='hsmImg' src='"+A+"/CRS?cd="+Math.random()+"' onload='' onerror='fnResult(this, false)' />"):(d=document.createElement("img"),d.setAttribute("id","hsmImg"),d.setAttribute("src",A+"/CRS?cd="+Math.random()));d.onerror=function(){c(d,!1)};d.onload=function(){c(d,!0)};d.style.display="none";document.body.appendChild(d);if(-1!=navigator.userAgent.indexOf("MSIE 8")){var e=function(){!1==v?setTimeout(e,100):c(null,!0)};setTimeout(e,100)}};0<E&&(E--,"function"===typeof window.addEventListener?window.removeEventListener("message",B,!1):window.detachEvent("onmessage",B));"function"===typeof window.addEventListener?window.addEventListener("message",B,!1):window.attachEvent("onmessage",B);E++;var g=function(a,b){if(-1!=b){var c=document.getElementById("us-div-cert-list-load");null!=c?k.uiUtil().loadingBox(!0,"us-div-cert-list-load",b):(c=document.getElementById("us-div-list-load"),k.uiUtil().loadingBox(!0,"us-div-list-load",b))}Q(function(b){b?a():confirm(k.uiUtil().getErrorMessageLang().IDS_ERROR_NIM_NOT_INSTALL_CFM)&&(null!=parent?parent.document.location=k.nimCheckUrl:document.location=k.nimCheckUrl)})};return{GetLastErrorCode:function(){return d},GetLastErrorMessage:function(){return e},GetVersion:function(a){g(function(){null==z?F(a):a(0,"",z)},-1)},IsAvailable:function(){return v},InitUniSignWebToolkit:function(a,b,c){g(function(){d=-1;e="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[1],manager:"ccsign",pki:k.ESVS.PKI,lang:"ko_kr"==k.ESVS.Language?0:1,domain:a,license:b}),h,c)},13)},GetCertForKeyboardEncrypt:function(a,b,c){g(function(){d=-1;e="";var p={messageNumber:h,sessionID:""+l,operation:f[4],manager:"ccsign",domain:a,license:b,options:{seckeyboard:q()}};m(JSON.stringify(p),h,c)})},SetUSIMOptions:function(a,b,c,f,h,t,l){g(function(){d=-1;e="";G(a,b,c,f,h,t,l)},14)},GetDiskList:function(a){g(function(){y(0);d=-1;e="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[6],manager:"ccsign"}),h,a)},14)},GetHSMList:function(a,b){g(function(){y(0);d=-1;e="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[8],manager:"ccsign",listtype:a}),h,b)},14)},IsInstalledUSIMModule:function(a,b,c){g(function(){y(0);d=-1;e="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[10],manager:"ccsign",vendor:a,checkonly:!0==b?1:0}),h,c)},14)},IssueCertificate:function(a,b,c,p,r,t,k,x,s,u){g(function(){d=-1;e="";var g=s;k==O&&(g=pwd);g={messageNumber:h,sessionID:""+l,operation:f[38],manager:"ccsign",ip:a,port:b,refnum:c,authcode:p,newpwd:n(r),newrepwd:n(t),device:k,drive:x,pin:n(g),options:{seckeyboard:q()}};m(JSON.stringify(g),h,u)},15)},IssueKMCertificate:function(a,b,c,p,r){g(function(){d=-1;e="";var g={messageNumber:h,sessionID:""+l,operation:f[41],manager:"ccsign",ip:a,port:b,index:c,pwd:n(p),options:{seckeyboard:q()}};m(JSON.stringify(g),h,r)},15)},RenewCertificate:function(a,b,c,p,r,t,k,x){g(function(){d=-1;e="";var g={messageNumber:h,sessionID:""+l,operation:f[39],manager:"ccsign",ip:a,port:b,index:c,newpwd:n(p),newrepwd:n(r),oldpwd:n(t),multiuse:!0==k?1:0,options:{seckeyboard:q()}};m(JSON.stringify(g),h,x)},4)},RevokeCertificate:function(a,b,c,p,r,t,k){g(function(){d=-1;e="";var g={messageNumber:h,sessionID:""+l,operation:f[40],manager:"ccsign",ip:a,port:b,index:c,pwd:n(p),reason:r,deletecert:t,options:{seckeyboard:q()}};m(JSON.stringify(g),h,k)},4)},GetAllUserCertListNum:function(a,b,c,f){g(function(){y(0);d=-1;e="";4==a?I(k.ubiKeyEnv.version,k.ubiKeyEnv.siteInfo,k.ubiKeyEnv.securityInfo,k.ubiKeyEnv.downloadURL,function(d){0==d?C(a,b,c,f):f(d,0)}):6==a?G(k.usimEnv.sitecode,k.usimEnv.modecode,k.usimEnv.siteURL,k.usimEnv.serviceIP,k.usimEnv.servicePort,k.usimEnv.downloadURL,function(d){0==d?C(a,b,c,f):f(d,0)}):C(a,b,c,f)},0)},GetAllUserCert:function(a,b){g(function(){function c(f,h,g){if(0==f)null!=g&&0<g.length&&(f={},f.index=d+1,f.cert=g,e[d]=f);else return b(f),!1;if(a==e.length)return __callback=null,b(0,e),!0;d+=1;D(d+1,c)}y(1);var d=0,e=[];D(d+1,c)},0)},ClearAllUserCertList:function(a){g(function(){d=-1;e="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[11],manager:"ccsign"}),h,a)},0)},GetSignCertFromCertList:function(a,b){g(function(){d=-1;e="";D(a,b)},0)},CheckPassword:function(a,b,c,p,r){g(function(){d=-1;e="";var g={messageNumber:h,sessionID:""+l,operation:f[20],manager:"ccsign",index:c,device:a,drive:b,pwd:n(p),options:{seckeyboard:q()}};m(JSON.stringify(g),h,r)},9)},CheckSCardConnected:function(a){g(function(){d=-1;e="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[21],manager:"ccsign"}),h,a)},9)},CheckSCardPin:function(a,b){g(function(){d=-1;e="";var c={messageNumber:h,sessionID:""+l,operation:f[22],manager:"ccsign",pin:n(a),options:{seckeyboard:q()}};m(JSON.stringify(c),h,b)},9)},GetPfxCertList:function(a,b,c,p){g(function(){d=-1;e="";var g={messageNumber:h,sessionID:""+l,operation:f[17],manager:"ccsign",input:{inputtype:a,inputdata:b},pwd:n(c),options:{seckeyboard:q()}};m(JSON.stringify(g),h,p)},0)},VerifyCertificate:function(a,b,c){g(function(){d=-1;e="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[18],manager:"ccsign",index:a,verifytype:b}),h,c)},12)},GetCACertificates:function(a,b){g(function(){d=-1;e="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[19],manager:"ccsign",index:a}),h,b)},-1)},GetSignDataP7:function(a,b,c,f,h,l,m,k){g(function(){d=-1;e="";H(a,b,0,"",c,f,h,l,m,k)},1)},GetSignDataP7WithHash:function(a,b,c,f,h,l,m,k,n){g(function(){d=-1;e="";H(a,b,1,c,f,h,l,m,k,n)},1)},GetSignDataP1:function(a,b,c,p,r){g(function(){d=-1;e="";var g={messageNumber:h,sessionID:""+l,operation:f[23],manager:"ccsign",index:a,pwd:n(b),plaintext:c,kmcert:p,options:{seckeyboard:q()}};m(JSON.stringify(g),h,r)},1)},VerifySignedData:function(a,b,c){g(function(){d=-1;e="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[26],manager:"ccsign",signeddata:b,plaintext:a}),h,c)},16)},VerifyP1SignData:function(a,b,c,p){g(function(){d=-1;e="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[25],manager:"ccsign",plaintext:a,signeddata:b,cert:c}),h,p)},16)},GetSignFileP7:function(a,b,c,p,r,k){g(function(){d=-1;e="";var g={messageNumber:h,sessionID:""+l,operation:f[27],manager:"ccsign",index:a,pwd:n(b),input:{inputdata:c[0],rewrite:c[3]},inCon:!0==p?1:0,rettype:c[1],outfilepath:c[2],kmcert:r,options:{seckeyboard:q()}};m(JSON.stringify(g),h,k)},1)},DeleteCert:function(a,b,c){g(function(){d=-1;e="";var g={messageNumber:h,sessionID:""+l,operation:f[13],manager:"ccmanager",index:a,pwd:n(b),options:{seckeyboard:q()}};m(JSON.stringify(g),h,c)},3)},ImportCert:function(a,b,c,p,r,k,s){g(function(){d=-1;e="";var g={messageNumber:h,sessionID:""+l,operation:f[15],manager:"ccmanager",input:{inputtype:a,inputdata:b},pwd:n(c),device:p,drive:r,pin:n(k),options:{seckeyboard:q()}};m(JSON.stringify(g),h,s)},6)},ExportCert:function(a,b,c){g(function(){d=-1;e="";var g={messageNumber:h,sessionID:""+l,operation:f[16],manager:"ccmanager_exp",index:a,pwd:n(b),options:{seckeyboard:q()}};m(JSON.stringify(g),h,c)},7)},CopyCert:function(a,b,c,p,k,t){g(function(){d=-1;e="";var g={messageNumber:h,sessionID:""+l,operation:f[12],manager:"ccmanager",index:a,pwd:n(b),device:c,drive:p,pin:n(k),options:{seckeyboard:q()}};m(JSON.stringify(g),h,t)},5)},ChangePassword:function(a,b,c,p){g(function(){d=-1;e="";var g={messageNumber:h,sessionID:""+l,operation:f[14],manager:"ccmanager",index:a,pwd:n(b),newpwd:n(c),options:{seckeyboard:q()}};m(JSON.stringify(g),h,p)},8)},VerifyVID:function(a,b,c,p,r){g(function(){d=-1;var g=e="",g=0==c?k.bsUtil().GetEnvelopedPwd(p):n(p),g={userin:c,ssn:g},g={messageNumber:h,sessionID:""+l,operation:f[28],manager:"ccsign",index:a,pwd:n(b),ssn:g,multiuse:!0==k.ESVS.multiuse?1:0,options:{seckeyboard:q()}};m(JSON.stringify(g),h,r)},12)},VerifySignedFile:function(a,b,c,p,k,n){g(function(){d=-1;e="";var g=0;null!=a&&(g=1);var q="",q=0==g?{messageNumber:h,sessionID:""+l,operation:f[44],manager:"ccsign",signtype:g,signdatatype:b,signeddata:c,rettype:p,outfilepath:k}:{messageNumber:h,sessionID:""+l,operation:f[44],manager:"ccsign",signtype:g,plaintext:a,signdatatype:b,signeddata:c,rettype:p,outfilepath:k};m(JSON.stringify(q),h,n)})},EnvelopData:function(a,b,c,p,k,t,s){g(function(){d=-1;e="";var g=1;"kmcert"==a&&(g=2);g={messageNumber:h,sessionID:""+l,operation:f[32],manager:"ccsign",certtype:g,index:b,pwd:n(c),kmcert:p,plaintext:k,multiuse:!0==t?1:0,options:{seckeyboard:q()}};m(JSON.stringify(g),h,s)},10)},DeEnvelopData:function(a,b,c,p,k){g(function(){d=-1;e="";var g=1;"kmcert"==a&&(g=2);g={messageNumber:h,sessionID:""+l,operation:f[33],manager:"ccsign",certtype:g,index:b,pwd:n(c),envelopeddata:p,options:{seckeyboard:q()}};m(JSON.stringify(g),h,k)},11)},ExportCertEx:function(a,b,c,k,r,t){g(function(){d=-1;e="";var g={messageNumber:h,sessionID:""+l,operation:f[29],manager:"ccsign",device:a,drive:b,index:c,pfxpwd:k,pwd:n(r),options:{seckeyboard:q()}};m(JSON.stringify(g),h,t)},7)},ImportCertEx:function(a,b,c,k,r,t,s){g(function(){d=-1;e="";var g={messageNumber:h,sessionID:""+l,operation:f[30],manager:"ccsign",device:a,drive:b,pin:n(c),pwd:n(k),pfx:r,pfxpwd:t,options:{seckeyboard:q()}};m(JSON.stringify(g),h,s)},6)},CheckPasswdCombination:function(a,b,c,k,r){g(function(){d=-1;e="";var g={messageNumber:h,sessionID:""+l,operation:f[45],manager:"ccsign",pwd:n(a),pwdmin:b,pwdmax:c,pwdlevel:k,options:{seckeyboard:q()}};m(JSON.stringify(g),h,r)},8)},CheckNewPasswdCombination:function(a,b,c,k,r,t){g(function(){d=-1;e="";var g={messageNumber:h,sessionID:""+l,operation:f[46],manager:"ccsign",newpwd:n(a),newrepwd:n(b),pwdmin:c,pwdmax:k,pwdlevel:r,options:{seckeyboard:q()}};m(JSON.stringify(g),h,t)},8)},GetBackupedDriveList:function(a){g(function(){d=-1;e="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[47],manager:"ccsign"}),h,a)},14)},BackupToUSB:function(a,b,c,k){g(function(){d=-1;e="";var g={messageNumber:h,sessionID:""+l,operation:f[48],manager:"ccsign",index:a,drive:b,pwd:n(c),options:{seckeyboard:q()}};m(JSON.stringify(g),h,k)},17)},GetBackupedSlot:function(a,b){g(function(){d=-1;e="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[49],manager:"ccsign",drive:a}),h,b)},17)},GetBackupedCertList:function(a,b){g(function(){d=-1;e="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[54],manager:"ccsign",drive:a}),h,b)},0)},RecoverFromUSB:function(a,b,c,k){g(function(){d=-1;e="";var g={messageNumber:h,sessionID:""+l,operation:f[50],manager:"ccsign",drive:a,index:b,pwd:n(c),options:{seckeyboard:q()}};m(JSON.stringify(g),h,k)},18)},GetSDList:function(a){g(function(){d=-1;e="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[51],manager:"ccsign"}),h,a)},14)},IsSDInstalled:function(a){g(function(){d=-1;e="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[52],manager:"ccsign"}),h,a)},14)},MakeHash:function(a,b,c,k){g(function(){d=-1;e="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[31],manager:"ccsign",inputtype:a,inputdata:b,hashalg:c}),h,k)},19)},EncryptData:function(a,b){g(function(){d=-1;e="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[34],manager:"ccsign",plaintext:a}),h,b)},20)},EncryptDataWithSymmKey:function(a,b,c,k,n){g(function(){d=-1;e="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[35],manager:"ccsign",alg:a,symmkey:b,charset:k,plaintext:c}),h,n)},20)},DecryptDataWithSymmKey:function(a,b,c,k,n,q){g(function(){d=-1;e="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[36],manager:"ccsign",alg:a,symmkey:b,fromcharset:k,charset:n,encrypteddata:c}),h,q)},20)},GetMacAddress:function(a,b){g(function(){m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[53],manager:"ccsign",mode:a}),h,b)})},MakeXMLDSIG:function(a,b,c,d,e){g(function(){var g={messageNumber:h,sessionID:""+l,operation:f[37],manager:"ccsign",index:a,pwd:n(b),inCon:0,plaintext:c,kmcert:d,options:{seckeyboard:q()}};m(JSON.stringify(g),h,e)},1)},CheckConnectToCAServer:function(a,b,c,d,e){g(function(){m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[55],manager:"ccmanager",ip:a,port:b,dirip:c,dirport:d}),h,e)},1)},SetSystemTimeFromTimeServer:function(a,b,c){g(function(){m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[56],manager:"ccmanager",ip:a,port:b}),h,c)},1)},IsUBIkeyInstalled:function(a){g(function(){m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[57],manager:"ccmanager"}),h,a)},14)}}};