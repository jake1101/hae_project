(function(){function n(h){(h.prng=h.prng||{}).create=function(f){function c(){if(32>a.pools[0].messageLength){var d=32-a.pools[0].messageLength<<5,b="",g,e,c;for(g=Math.floor(65535*Math.random());b.length<d;)for(e=16807*(g&65535),g=16807*(g>>16),e+=(g&32767)<<16,e+=g>>15,e=(e&2147483647)+(e>>31),g=e&4294967295,e=0;3>e;++e)c=g>>>(e<<3),c^=Math.floor(255*Math.random()),b+=String.fromCharCode(c&255);a.collect(b)}else{d=h.md.sha1.create();d.update(a.pools[0].digest().getBytes());a.pools[0].start();for(e=b=1;32>e;++e)b=31==b?2147483648:b<<2,0===b%a.reseeds&&(d.update(a.pools[e].digest().getBytes()),a.pools[e].start());b=d.digest().getBytes();d.start();d.update(b);d=d.digest().getBytes();a.key=a.plugin.formatKey(b);a.seed=a.plugin.formatSeed(d);++a.reseeds;a.generated=0;a.time=+new Date}}var a={plugin:f,key:null,seed:null,time:null,reseeds:0,generated:0};f=f.md;for(var k=Array(32),l=0;32>l;++l)k[l]=f.create();a.pools=k;a.pool=0;a.generate=function(d){null===a.key&&c();for(var b=a.plugin.cipher,g=a.plugin.increment,e=a.plugin.formatKey,f=a.plugin.formatSeed,k=h.util.createBuffer();k.length()<d;){var l=b(a.key,a.seed);a.generated+=l.length;k.putBytes(l);a.key=e(b(a.key,g(a.seed)));a.seed=f(b(a.key,a.seed));1048576<=a.generated&&100>+new Date-a.time&&c()}return k.getBytes(d)};a.collect=function(d){for(var b=d.length,g=0;g<b;++g)a.pools[a.pool].update(d.substr(g,1)),a.pool=31===a.pool?0:a.pool+1;32<=a.pools[0].messageLength&&(d=+new Date,(null===a.time||100>d-a.time)&&c())};a.collectInt=function(d,b){var c="";do b-=8,c+=String.fromCharCode(d>>b&255);while(0<b);a.collect(c)};return a}}var p=["./md","./util"],m=null;"function"!==typeof define&&("object"===typeof module&&module.exports?m=function(h,f){f(require,module)}:(crosscert=window.crosscert=window.crosscert||{},n(crosscert)));(m||"function"===typeof define)&&(m||define)(["require","module"].concat(p),function(h,f){f.exports=function(c){var a=p.map(function(a){return h(a)}).concat(n);c=c||{};c.defined=c.defined||{};if(c.defined.prng)return c.prng;c.defined.prng=!0;for(var f=0;f<a.length;++f)a[f](c);return c.prng}})})();